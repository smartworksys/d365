using System;
using System.Net.Http;
using System.Text;
using System.Threading.Tasks;
using Newtonsoft.Json.Linq;

class Program
{
    static async Task Main(string[] args)
    {
        string url = "https://kofcmodel.stoneriver.com/services/GatewayRESTService.svc/processRequest:443";
        var client = new HttpClient();

        // JSON payload
        string xmlPayload = "<?xml version='1.0' encoding='UTF-8'?>\\n<FIPSCOLINKFILE VERSION=\"1.00\">...</FIPSCOLINKFILE>";
        string jsonPayload = JsonConvert.SerializeObject(new { request = xmlPayload });

        // Set up the request content with the appropriate headers
        var content = new StringContent(jsonPayload, Encoding.UTF8, "application/json");

        try
        {
            // Make the HTTP POST request
            var response = await client.PostAsync(url, content);

            // Print request headers
            Console.WriteLine("Request Headers:");
            foreach (var header in client.DefaultRequestHeaders)
            {
                Console.WriteLine($"{header.Key}: {header.Value}");
            }

            // Print response headers
            Console.WriteLine("\nResponse Headers:");
            foreach (var header in response.Headers)
            {
                Console.WriteLine($"{header.Key}: {string.Join(", ", header.Value)}");
            }

            // Optionally, print the response body
            string responseBody = await response.Content.ReadAsStringAsync();
            Console.WriteLine("\nResponse Body:");
            Console.WriteLine(responseBody);
        }
        catch (Exception ex)
        {
            Console.WriteLine($"An error occurred: {ex.Message}");
        }
    }
}
