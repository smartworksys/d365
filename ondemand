function onSave(executionContext) {
    var formContext = executionContext.getFormContext();
    var saveEvent = executionContext.getEventArgs();
    var saveMode = saveEvent.getSaveMode();

    var confirmOptions = { text: "Are you sure you want to proceed?" };
    var manualReview = formContext.getAttribute("manual_review").getValue();
    if (manualReview) {
        saveEvent.preventDefault(); // Prevent default save to control the flow

        Xrm.Navigation.openConfirmDialog(confirmOptions).then(function (result) {
            if (result.confirmed) {
                // Set attribute to always submit to ensure save operation proceeds
                formContext.getAttribute("manual_review").setSubmitMode("always");

                // Handle both save and save and close based on the mode detected
                if (saveMode === 1 || saveMode === 70) { // Normal save or autosave
                    formContext.data.save();
                } else if (saveMode === 2) { // Save and close
                    formContext.data.save("saveandclose");
                }
            } else {
                console.log("Save canceled by user.");
            }
        });
    }
}
