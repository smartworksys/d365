var count = 0;

function OnFormSave(executionObj) {
    var eventArgs = executionObj.getEventArgs();
    var formContext = executionObj.getFormContext();

    // Prevent default save operation initially
    if (count === 0) {
        eventArgs.preventDefault();

        if (formContext.ui.getFormType() === 1) {
            var confirmStrings = {
                text: "Are you sure you want to continue to save the record?",
                title: "Warning"
            };
            var confirmOptions = { height: 250, width: 500 };
            Xrm.Navigation.openConfirmDialog(confirmStrings, confirmOptions).then(
                function (result) {
                    if (result.confirmed) {
                        count++; // Increment count to avoid repeated confirmations
                        formContext.data.save(); // Attempt to save the form
                    } else {
                        console.log("User cancelled the save.");
                        // Handle cancellation logic, if any
                    }
                });
        }
    }
}
