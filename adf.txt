let duplicateNotifId;
const formContext = executionContext.getFormContext();

if (result.entities.length > 0) {
    const record      = result.entities[0];
    const recordGuid  = record.nf1pbm_maturityinstructionsid;
    const recordTitle = record.nf1pbm_maturityinstructionid;

    Xrm.App.addGlobalNotification({
        type:            2,
        level:           2,
        message:         formatString(CONSTANTS.MESSAGES.DUPLICATE_RECORD, recordTitle),
        showCloseButton: true,
        action: {
            actionLabel: `View ${recordTitle}`,
            eventHandler: function () {
                formContext.data.entity.attributes.get().forEach(attr => attr.setSubmitMode("never"));
                Xrm.Navigation.openForm({
                    entityName: CONSTANTS.ENTITY_NAMES.MATURITY_INSTRUCTIONS,
                    entityId:   recordGuid
                }).then(function () {
                    Xrm.App.clearGlobalNotification(duplicateNotifId);
                    window.location.reload();
                }).catch(function (err) {
                    console.error(err);
                });
            }
        }
    }).then(function (notifId) {
        duplicateNotifId = notifId;
    }).catch(function (err) {
        console.error(err);
    });

    makeFormReadOnly(executionContext);
    return [];
}
